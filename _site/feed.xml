<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.1">Jekyll</generator><link href="http://0.0.0.0:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://0.0.0.0:4000/" rel="alternate" type="text/html" /><updated>2019-12-01T18:26:38+08:00</updated><id>http://0.0.0.0:4000/</id><title type="html">Breeze and me</title><subtitle>如果所有人都理解你会普通成什么样子</subtitle><author><name>true</name></author><entry><title type="html">ORM简介</title><link href="http://0.0.0.0:4000/2019/12/01/django-orm-introduction.html" rel="alternate" type="text/html" title="ORM简介" /><published>2019-12-01T10:30:00+08:00</published><updated>2019-12-01T10:30:00+08:00</updated><id>http://0.0.0.0:4000/2019/12/01/django-orm-introduction</id><content type="html" xml:base="http://0.0.0.0:4000/2019/12/01/django-orm-introduction.html">&lt;h2 id=&quot;orm简介&quot;&gt;ORM简介&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;本文所述django中ORM&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;什么是orm&quot;&gt;什么是ORM&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;全称：object relational mapping，通过使用它，我们可以直接使用python的方法去使用数据库&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;通过把表映射成类，把行作为实例，把字段作为属性，orm在执行对象操作的时候会把对应的操作转换成数据库原生语句的方式来完成数据库开发工作&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;orm的优点&quot;&gt;ORM的优点&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;使用简单，通过将数据库语法进行封装，直接使用方法即可操作数据库&lt;/li&gt;
  &lt;li&gt;性能好，在通过orm转换成sql的时候是会有一些消耗，但这个消耗其实非常低，在对整体业务提升的角度说，这点消耗可以忽略不计，除非你对于io操作的要求非常的极端&lt;/li&gt;
  &lt;li&gt;兼容性好，支持目前市面上多数的关系型数据库，如mysql prestresql salite等&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;基础配置&quot;&gt;基础配置&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;注意修改自己django或其他文件安装路径&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;使用pymysql代替mysqlclient&quot;&gt;使用pymysql代替mysqlclient&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;p&gt;在django中，mysql连接的默认客户端是mysqlclient，但是其并不支持python3&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;执行初始化命令 &lt;code class=&quot;highlighter-rouge&quot;&gt;python manage.py makemigrations&lt;/code&gt; 报错信息
    &lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  (base) [soul@listener one_orm]$ python manage.py makemigrations
  Traceback (most recent call last):
    File &quot;manage.py&quot;, line 21, in &amp;lt;module&amp;gt;
      main()
    File &quot;manage.py&quot;, line 17, in main
      execute_from_command_line(sys.argv)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/__init__.py&quot;, line 381, in execute_from_command_line
      utility.execute()
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/__init__.py&quot;, line 357, in execute
      django.setup()
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/__init__.py&quot;, line 24, in setup
      apps.populate(settings.INSTALLED_APPS)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/apps/registry.py&quot;, line 114, in populate
      app_config.import_models()
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/apps/config.py&quot;, line 211, in import_models
      self.models_module = import_module(models_module_name)
    File &quot;/home/soul/anaconda3/lib/python3.6/importlib/__init__.py&quot;, line 126, in import_module
      return _bootstrap._gcd_import(name[level:], package, level)
    File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 994, in _gcd_import
    File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 971, in _find_and_load
    File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 955, in _find_and_load_unlocked
    File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 665, in _load_unlocked
    File &quot;&amp;lt;frozen importlib._bootstrap_external&amp;gt;&quot;, line 678, in exec_module
    File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 219, in _call_with_frames_removed
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/contrib/auth/models.py&quot;, line 2, in &amp;lt;module&amp;gt;
      from django.contrib.auth.base_user import AbstractBaseUser, BaseUserManager
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/contrib/auth/base_user.py&quot;, line 47, in &amp;lt;module&amp;gt;
      class AbstractBaseUser(models.Model):
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/models/base.py&quot;, line 117, in __new__
      new_class.add_to_class('_meta', Options(meta, app_label))
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/models/base.py&quot;, line 321, in add_to_class
      value.contribute_to_class(cls, name)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/models/options.py&quot;, line 204, in contribute_to_class
      self.db_table = truncate_name(self.db_table, connection.ops.max_name_length())
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/__init__.py&quot;, line 28, in __getattr__
      return getattr(connections[DEFAULT_DB_ALIAS], item)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/utils.py&quot;, line 201, in __getitem__
      backend = load_backend(db['ENGINE'])
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/utils.py&quot;, line 110, in load_backend
      return import_module('%s.base' % backend_name)
    File &quot;/home/soul/anaconda3/lib/python3.6/importlib/__init__.py&quot;, line 126, in import_module
      return _bootstrap._gcd_import(name[level:], package, level)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/mysql/base.py&quot;, line 36, in &amp;lt;module&amp;gt;
      raise ImproperlyConfigured('mysqlclient 1.3.13 or newer is required; you have %s.' % Database.__version__)
  django.core.exceptions.ImproperlyConfigured: mysqlclient 1.3.13 or newer is required; you have 0.9.3.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;修改 &lt;code class=&quot;highlighter-rouge&quot;&gt;init.py&lt;/code&gt; 文件&lt;br /&gt;
  修改项目setting同文件目录下的 &lt;code class=&quot;highlighter-rouge&quot;&gt;init.py&lt;/code&gt; 文件，添加如下代码：
    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pymysql&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# 告诉Django，用pymysql代替MySQLdb（MySQLdb不支持中py3）&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;pymysql&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install_as_MySQLdb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;修改版本限制&quot;&gt;修改版本限制&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;p&gt;在django中，虽然我们使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;pymysql&lt;/code&gt; 替换 &lt;code class=&quot;highlighter-rouge&quot;&gt;mysqlclient&lt;/code&gt; ，但django仍然会检查 &lt;code class=&quot;highlighter-rouge&quot;&gt;mysqlclient&lt;/code&gt; 的版本，所以会出先如下报错&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;```text  
(base) [soul@listener one_orm]$ python manage.py makemigrations
Traceback (most recent call last):
  File &quot;manage.py&quot;, line 21, in &amp;lt;module&amp;gt;
    main()
  File &quot;manage.py&quot;, line 17, in main
    execute_from_command_line(sys.argv)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/__init__.py&quot;, line 381, in execute_from_command_line
    utility.execute()
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/__init__.py&quot;, line 357, in execute
    django.setup()
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/__init__.py&quot;, line 24, in setup
    apps.populate(settings.INSTALLED_APPS)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/apps/registry.py&quot;, line 114, in populate
    app_config.import_models()
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/apps/config.py&quot;, line 211, in import_models
    self.models_module = import_module(models_module_name)
  File &quot;/home/soul/anaconda3/lib/python3.6/importlib/__init__.py&quot;, line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 994, in _gcd_import
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 971, in _find_and_load
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 955, in _find_and_load_unlocked
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 665, in _load_unlocked
  File &quot;&amp;lt;frozen importlib._bootstrap_external&amp;gt;&quot;, line 678, in exec_module
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 219, in _call_with_frames_removed
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/contrib/auth/models.py&quot;, line 2, in &amp;lt;module&amp;gt;
    from django.contrib.auth.base_user import AbstractBaseUser, BaseUserManager
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/contrib/auth/base_user.py&quot;, line 47, in &amp;lt;module&amp;gt;
    class AbstractBaseUser(models.Model):
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/models/base.py&quot;, line 117, in __new__
    new_class.add_to_class('_meta', Options(meta, app_label))
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/models/base.py&quot;, line 321, in add_to_class
    value.contribute_to_class(cls, name)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/models/options.py&quot;, line 204, in contribute_to_class
    self.db_table = truncate_name(self.db_table, connection.ops.max_name_length())
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/__init__.py&quot;, line 28, in __getattr__
    return getattr(connections[DEFAULT_DB_ALIAS], item)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/utils.py&quot;, line 201, in __getitem__
    backend = load_backend(db['ENGINE'])
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/utils.py&quot;, line 110, in load_backend
    return import_module('%s.base' % backend_name)
  File &quot;/home/soul/anaconda3/lib/python3.6/importlib/__init__.py&quot;, line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/mysql/base.py&quot;, line 36, in &amp;lt;module&amp;gt;
    raise ImproperlyConfigured('mysqlclient 1.3.13 or newer is required; you have %s.' % Database.__version__)
django.core.exceptions.ImproperlyConfigured: mysqlclient 1.3.13 or newer is required; you have 0.9.3.
(base) [soul@listener one_orm]$ ^C
(base) [soul@listener one_orm]$ python manage.py makemigrations
Traceback (most recent call last):
  File &quot;manage.py&quot;, line 21, in &amp;lt;module&amp;gt;
    main()
  File &quot;manage.py&quot;, line 17, in main
    execute_from_command_line(sys.argv)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/__init__.py&quot;, line 381, in execute_from_command_line
    utility.execute()
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/__init__.py&quot;, line 357, in execute
    django.setup()
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/__init__.py&quot;, line 24, in setup
    apps.populate(settings.INSTALLED_APPS)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/apps/registry.py&quot;, line 114, in populate
    app_config.import_models()
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/apps/config.py&quot;, line 211, in import_models
    self.models_module = import_module(models_module_name)
  File &quot;/home/soul/anaconda3/lib/python3.6/importlib/__init__.py&quot;, line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 994, in _gcd_import
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 971, in _find_and_load
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 955, in _find_and_load_unlocked
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 665, in _load_unlocked
  File &quot;&amp;lt;frozen importlib._bootstrap_external&amp;gt;&quot;, line 678, in exec_module
  File &quot;&amp;lt;frozen importlib._bootstrap&amp;gt;&quot;, line 219, in _call_with_frames_removed
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/contrib/auth/models.py&quot;, line 2, in &amp;lt;module&amp;gt;
    from django.contrib.auth.base_user import AbstractBaseUser, BaseUserManager
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/contrib/auth/base_user.py&quot;, line 47, in &amp;lt;module&amp;gt;
    class AbstractBaseUser(models.Model):
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/models/base.py&quot;, line 117, in __new__
    new_class.add_to_class('_meta', Options(meta, app_label))
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/models/base.py&quot;, line 321, in add_to_class
    value.contribute_to_class(cls, name)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/models/options.py&quot;, line 204, in contribute_to_class
    self.db_table = truncate_name(self.db_table, connection.ops.max_name_length())
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/__init__.py&quot;, line 28, in __getattr__
    return getattr(connections[DEFAULT_DB_ALIAS], item)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/utils.py&quot;, line 201, in __getitem__
    backend = load_backend(db['ENGINE'])
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/utils.py&quot;, line 110, in load_backend
    return import_module('%s.base' % backend_name)
  File &quot;/home/soul/anaconda3/lib/python3.6/importlib/__init__.py&quot;, line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/mysql/base.py&quot;, line 36, in &amp;lt;module&amp;gt;
    raise ImproperlyConfigured('mysqlclient 1.3.13 or newer is required; you have %s.' % Database.__version__)
django.core.exceptions.ImproperlyConfigured: mysqlclient 1.3.13 or newer is required; you have 0.9.3.

```  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;解决方案：&lt;/strong&gt; 修改 &lt;code class=&quot;highlighter-rouge&quot;&gt;django&lt;/code&gt; 关于 &lt;code class=&quot;highlighter-rouge&quot;&gt;mysql&lt;/code&gt; 配置源码
    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c&quot;&gt;# 文件路径(按照自己的修改)&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# /home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/mysql/base.py&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# 注释如下部分(35行)&lt;/span&gt;
      
  &lt;span class=&quot;c&quot;&gt;# if version &amp;lt; (1, 3, 13):&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;#     raise ImproperlyConfigured('mysqlclient 1.3.13 or newer is required; you have %s.' % Database.__version__)&lt;/span&gt;
    
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;配置mysql连接&quot;&gt;配置mysql连接&lt;/h2&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;在 `setting.py` 中，修改DATABASES部分配置如下  

```text
# Database
# https://docs.djangoproject.com/en/2.2/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',  # 数据库引擎
        'NAME': 'lession4',
        'USER': 'root',
        'PASSWORD': '****,
        'HOST': '127.0.0.1',
        'PORT': '3306',
    }
}
```
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;modelspy编写&quot;&gt;models.py编写&lt;/h4&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.db&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Create your models here.&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CharField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;username&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CharField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 唯一索引,不允许为空&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;age&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SmallIntegerField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;phone&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IntegerField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 普通索引&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;email&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EmailField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;blank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TextField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;create_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DateTimeField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;auto_now_add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;update_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DateTimeField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;auto_now&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c&quot;&gt;# 联合索引,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Meta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;index_together&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'username'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'phone'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'user:{}'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c&quot;&gt;# 一对一数据表, 一人一个生日&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Userprofile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OneToOneField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on_delete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SET_NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# 一对一, on_delete, null=True是必要参数, 删除时可以设置为空，django2.2新增类型OneToOneField&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;birthday&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CharField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'user: {}, birthday: {}'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;birthday&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c&quot;&gt;# 一对多数据表， 一个人多个日记&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Diary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ForeignKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;related_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'diary'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on_delete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SET_NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# 自定义外键名称related_name&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TextField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# 时间类型实际存入int型，等于存入时间戳，便于不同场景下的时间转换&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;create_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IntegerField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 多对多数据表，一个人有多个组，一个组里有多个人&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ManyToManyField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;related_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'group'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CharField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;create_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IntegerField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;数据同步&quot;&gt;数据同步&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Python mange.py makemigrateions 在migrate文件夹下生成 initialpy脚本文件&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Python manage.py migrate 将initialpy脚本中的代码执行，生成相对应的数据表&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;字段对应sql类型&quot;&gt;字段对应SQL类型&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;字符串与数字类型&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;字段名&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
          &lt;th&gt;例子&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;CharField&lt;/td&gt;
          &lt;td&gt;字符串类型&lt;/td&gt;
          &lt;td&gt;‘namexxxx’&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;TextField&lt;/td&gt;
          &lt;td&gt;文本类型&lt;/td&gt;
          &lt;td&gt;‘xxxxxxxxxxxx…’&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;EmailField&lt;/td&gt;
          &lt;td&gt;邮箱类型&lt;/td&gt;
          &lt;td&gt;‘xxx@muke.com’&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;UrlField&lt;/td&gt;
          &lt;td&gt;网址类型&lt;/td&gt;
          &lt;td&gt;’http://muke.com’&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;BooleanField&lt;/td&gt;
          &lt;td&gt;布尔类型(tinyint)&lt;/td&gt;
          &lt;td&gt;True False&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;NullBooleanField&lt;/td&gt;
          &lt;td&gt;可为空的布尔类型&lt;/td&gt;
          &lt;td&gt;None True False&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;IntegerField&lt;/td&gt;
          &lt;td&gt;整型&lt;/td&gt;
          &lt;td&gt;(-2147483648, 2147483647)&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;SmallIntegerField&lt;/td&gt;
          &lt;td&gt;短整型&lt;/td&gt;
          &lt;td&gt;(-32768, 32767)&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;BigIntegerField&lt;/td&gt;
          &lt;td&gt;长整型&lt;/td&gt;
          &lt;td&gt;(-9223372036854775808, 9223372036854775807),&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;PositiveIntegerField&lt;/td&gt;
          &lt;td&gt;正整型&lt;/td&gt;
          &lt;td&gt;(0, 2147483647)&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;PositiveSmallIntegerField&lt;/td&gt;
          &lt;td&gt;短正整型&lt;/td&gt;
          &lt;td&gt;(0, 32767)&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;FloatField&lt;/td&gt;
          &lt;td&gt;浮点类型&lt;/td&gt;
          &lt;td&gt;3.14&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;DecimalField&lt;/td&gt;
          &lt;td&gt;十进制小树&lt;/td&gt;
          &lt;td&gt;12345.12312&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;时间类型&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;字段名&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
          &lt;th&gt;例子&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;DateField&lt;/td&gt;
          &lt;td&gt;日期类型&lt;/td&gt;
          &lt;td&gt;xxxx-xx-xx&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;DateTimeField&lt;/td&gt;
          &lt;td&gt;日期类型&lt;/td&gt;
          &lt;td&gt;xxxx-xx-xx xx:xx:xx&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;TimeField&lt;/td&gt;
          &lt;td&gt;时间类型&lt;/td&gt;
          &lt;td&gt;xx:xx:xx  (时分秒)&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;文件类型&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;字段名&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
          &lt;th&gt;例子&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;ImageField&lt;/td&gt;
          &lt;td&gt;图片类型&lt;/td&gt;
          &lt;td&gt;xxx.jpg&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;FileField&lt;/td&gt;
          &lt;td&gt;文件类型&lt;/td&gt;
          &lt;td&gt;任意文件类型&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;特殊类型属性介绍&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;属性名&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
          &lt;th&gt;例子&lt;/th&gt;
          &lt;th&gt;作用于&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;max_digits&lt;/td&gt;
          &lt;td&gt;数字中允许的最大位数&lt;/td&gt;
          &lt;td&gt;12&lt;/td&gt;
          &lt;td&gt;DecimalField&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;decimal_places&lt;/td&gt;
          &lt;td&gt;存储的十进制位数&lt;/td&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;DecimalField&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;width_field&lt;/td&gt;
          &lt;td&gt;图片宽(可不传)&lt;/td&gt;
          &lt;td&gt;1024&lt;/td&gt;
          &lt;td&gt;ImageField&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;height_field&lt;/td&gt;
          &lt;td&gt;图片高(可不传)&lt;/td&gt;
          &lt;td&gt;576&lt;/td&gt;
          &lt;td&gt;ImageField&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;upload_to&lt;/td&gt;
          &lt;td&gt;保存上传文件的本地文件路径，该路径由 MEDIA_ROOT 中设置&lt;/td&gt;
          &lt;td&gt;‘/xx/xx.xx’&lt;/td&gt;
          &lt;td&gt;ImageField, FileField&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;公共属性介绍&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;属性名&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
          &lt;th&gt;例子&lt;/th&gt;
          &lt;th&gt;作用于&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;null&lt;/td&gt;
          &lt;td&gt;值是否设为空&lt;/td&gt;
          &lt;td&gt;True False&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;blank&lt;/td&gt;
          &lt;td&gt;值是否可为空&lt;/td&gt;
          &lt;td&gt;True False&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;primary_key&lt;/td&gt;
          &lt;td&gt;设置主键&lt;/td&gt;
          &lt;td&gt;True&lt;/td&gt;
          &lt;td&gt;整型&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;auto_now&lt;/td&gt;
          &lt;td&gt;时间自动添加&lt;/td&gt;
          &lt;td&gt;True&lt;/td&gt;
          &lt;td&gt;时间类型&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;auto_now_add&lt;/td&gt;
          &lt;td&gt;自动添加时间，但仅在创建的时候&lt;/td&gt;
          &lt;td&gt;True&lt;/td&gt;
          &lt;td&gt;时间类型&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;max_length&lt;/td&gt;
          &lt;td&gt;字段长度&lt;/td&gt;
          &lt;td&gt;字符串类型&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;default&lt;/td&gt;
          &lt;td&gt;默认值&lt;/td&gt;
          &lt;td&gt;xxx&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;verbose_name&lt;/td&gt;
          &lt;td&gt;admin中显示的名字&lt;/td&gt;
          &lt;td&gt;name&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;db_column&lt;/td&gt;
          &lt;td&gt;数据库字段名&lt;/td&gt;
          &lt;td&gt;age&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;unique&lt;/td&gt;
          &lt;td&gt;唯一索引&lt;/td&gt;
          &lt;td&gt;True&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;de_index&lt;/td&gt;
          &lt;td&gt;普通索引&lt;/td&gt;
          &lt;td&gt;True&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;表关联方法&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;字段名&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
          &lt;th&gt;例子&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;ForeignKey&lt;/td&gt;
          &lt;td&gt;一对多&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;OneToOneField&lt;/td&gt;
          &lt;td&gt;一对一&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;ManyToManyField&lt;/td&gt;
          &lt;td&gt;多对多&lt;/td&gt;
          &lt;td&gt; &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;

    &lt;p&gt;定义外键关系，如 &lt;code class=&quot;highlighter-rouge&quot;&gt;OneToOne&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;OneToMany&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;ManyToMany&lt;/code&gt;关系中的 &lt;code class=&quot;highlighter-rouge&quot;&gt;models.OneToOneField&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;models.ForeignKey&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;models.ManyToManyField&lt;/code&gt;字段时，拥有如下属性&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;属性名&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
          &lt;th&gt;例子&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;related_name&lt;/td&gt;
          &lt;td&gt;关联表的名&lt;/td&gt;
          &lt;td&gt;related_name=‘profile’&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;on_delete&lt;/td&gt;
          &lt;td&gt;外键的删除的对策&lt;/td&gt;
          &lt;td&gt;on_delete=models. SET_NULL(CASCADE, PROTECT)&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;

    &lt;p&gt;实例代码：&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OneToOneField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on_delete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SET_NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
 &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ForeignKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;related_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'diary'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on_delete&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SET_NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
 &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;models&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ManyToManyField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;related_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'group'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;注： &lt;code class=&quot;highlighter-rouge&quot;&gt;ManyToManyField&lt;/code&gt; 没有 &lt;code class=&quot;highlighter-rouge&quot;&gt;on_delete&lt;/code&gt; 属性&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name>qifeng</name></author><category term="django" /><category term="orm" /><summary type="html">ORM简介</summary></entry><entry><title type="html">你好</title><link href="http://0.0.0.0:4000/2019/11/30/nihao.html" rel="alternate" type="text/html" title="你好" /><published>2019-11-30T09:30:00+08:00</published><updated>2019-11-30T09:30:00+08:00</updated><id>http://0.0.0.0:4000/2019/11/30/nihao</id><content type="html" xml:base="http://0.0.0.0:4000/2019/11/30/nihao.html">&lt;h1 id=&quot;你好啊&quot;&gt;你好啊&lt;/h1&gt;

&lt;h4 id=&quot;陌生人&quot;&gt;陌生人&lt;/h4&gt;

&lt;p&gt;是梦，那就打碎它&lt;/p&gt;

&lt;p&gt;努力去飞吧&lt;/p&gt;</content><author><name>Jekyll</name></author><category term="welcome" /><summary type="html">你好啊 陌生人 是梦，那就打碎它 努力去飞吧</summary></entry><entry><title type="html">Linux杀死其他tty终端</title><link href="http://0.0.0.0:4000/2019/11/30/linux-kill-tty.html" rel="alternate" type="text/html" title="Linux杀死其他tty终端" /><published>2019-11-30T08:30:00+08:00</published><updated>2019-11-30T08:30:00+08:00</updated><id>http://0.0.0.0:4000/2019/11/30/linux-kill-tty</id><content type="html" xml:base="http://0.0.0.0:4000/2019/11/30/linux-kill-tty.html">&lt;h2 id=&quot;linux杀死tty终端进程&quot;&gt;Linux杀死tty终端进程&lt;/h2&gt;

&lt;h4 id=&quot;用-ps--t-命令可以得到终端的进程号&quot;&gt;用 &lt;code class=&quot;highlighter-rouge&quot;&gt;ps -t&lt;/code&gt; 命令可以得到终端的进程号&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ps -t tty1

PID TTY TIME CMD

31419 tty1 00:00:00 bash
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;用-kill--9-命令可以将进程杀掉以关闭终端&quot;&gt;用 &lt;code class=&quot;highlighter-rouge&quot;&gt;kill -9&lt;/code&gt; 命令可以将进程杀掉，以关闭终端&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ kill -9 31419
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>qifeng</name></author><category term="linux" /><category term="tty" /><summary type="html">Linux杀死tty终端进程</summary></entry><entry><title type="html">CentOS7升级内核版本</title><link href="http://0.0.0.0:4000/2019/11/30/centos7-kernel-update.html" rel="alternate" type="text/html" title="CentOS7升级内核版本" /><published>2019-11-30T08:20:00+08:00</published><updated>2019-11-30T08:20:00+08:00</updated><id>http://0.0.0.0:4000/2019/11/30/centos7-kernel-update</id><content type="html" xml:base="http://0.0.0.0:4000/2019/11/30/centos7-kernel-update.html">&lt;h2 id=&quot;centos7升级linux内核&quot;&gt;CentOS7升级Linux内核&lt;/h2&gt;

&lt;h3 id=&quot;1-关于linux内核&quot;&gt;1. 关于Linux内核&lt;/h3&gt;
&lt;p&gt;Linux 内核分两种：官方内核（通常是内核开发人员用）和各大 Linux 发行版内核（一般用户常用）&lt;/p&gt;

&lt;h4 id=&quot;11-官方内核&quot;&gt;1.1 官方内核&lt;/h4&gt;

&lt;p&gt;在使用 Docker 时，发现其对 Linux 内核版本的最低要求是 3.10（这也刚好是 CentOS 7.2 的内核版本），但是在这个版本上有部分功能无法实现。目前 Linux 内核已经发布到 4.X（可以随时在 &lt;a href=&quot;https://www.kernel.org/&quot;&gt;Linux 内核官网&lt;/a&gt; 查看当前版本），为了使用最新版本的内核，只好在安装 CentOS 7 后对内核进行升级。&lt;/p&gt;

&lt;p&gt;当然，内核也不能选最新的，防止有尚未发现的 BUG。而且为了减少以后停止维护带来的麻烦，最好安装长期支持版本。各个版本的支持时间在 &lt;a href=&quot;https://www.kernel.org/category/releases.html&quot;&gt;这个页面&lt;/a&gt; 查看。每个版本可能有四种类型，概述如下：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Prepatch：Prepatch 或 “RC” 内核是主要的内核预发行版本，主要针对内核开发人员和 Linux 爱好者。必须从源代码进行编译，并且通常包含必须在可以放入稳定版本之前进行测试的新功能。Prepatch 内核由 Linus Torvalds 维护和发布。&lt;/li&gt;
  &lt;li&gt;Mainline：Mainline 主线树由 Linus Torvalds 维护。这个版本的内核会引入所有新功能。新的 Mainline 内核每 2-3 个月发布一次。&lt;/li&gt;
  &lt;li&gt;Stable：每个主线内核被发布后，即被认为是“stable”。任何对 stable 内核的 BUG 修复都会从 Mainline 主线树中回溯并由指定的 stable 内核维护人员使用。 在下一个主线内核可用之前，通常只有几个 BUG 修复内核版本 - 除非它被指定为“longterm maintenance kernel（长期维护内核）”。stable 内核更新按需发布，通常每月 2-3 次。&lt;/li&gt;
  &lt;li&gt;Longterm：通常会提供几个“longterm maintenance”内核版本，用于修复旧版内核的 BUG。这些内核只会修复重大 BUG，并且不会频繁发布版本&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;12-各大-linux-发行版内核&quot;&gt;1.2 各大 Linux 发行版内核&lt;/h4&gt;

&lt;p&gt;一般来说，只有从 &lt;code class=&quot;highlighter-rouge&quot;&gt;kernel.org&lt;/code&gt; 下载并编译安装的内核才是官方内核。
大多数 &lt;code class=&quot;highlighter-rouge&quot;&gt;Linux&lt;/code&gt; 发行版提供自行维护的内核，可以通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;yum&lt;/code&gt; 或 &lt;code class=&quot;highlighter-rouge&quot;&gt;rpm&lt;/code&gt; 等包管理系统升级。这些内核可能不再和 &lt;code class=&quot;highlighter-rouge&quot;&gt;Linux&lt;/code&gt; 内核官方开发维护人员有关系了。通过这个由各大 &lt;code class=&quot;highlighter-rouge&quot;&gt;Linux&lt;/code&gt; 发行版支持的仓库升级内核，通常来说更简单可靠，但是可选择的内核版本也更少。&lt;/p&gt;

&lt;p&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;uname -r&lt;/code&gt; 区分你用的是官方内核还是 &lt;code class=&quot;highlighter-rouge&quot;&gt;Linux&lt;/code&gt; 发行版内核，横线后面有任何东西都表示这不是官方内核：&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   # uname -r
   3.10.0-514.26.2.el7.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-查看当前的内核版本&quot;&gt;2. 查看当前的内核版本&lt;/h3&gt;
&lt;h4 id=&quot;21-概述&quot;&gt;2.1 概述&lt;/h4&gt;
&lt;p&gt;Linux 只表示内核。各大 Linux 发行版（RedHat、Ubuntu、CentOS 等）在内核基础上集成了其他的一系列软件，按照各自的版本规则发布。例如 CentOS 7.2 中，通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;uname -r&lt;/code&gt; 查看内核版本时，会看到 &lt;code class=&quot;highlighter-rouge&quot;&gt;3.10.0-514.26.2.el7.x86_64&lt;/code&gt;，表示对应的 Linux 内核版本是 &lt;code class=&quot;highlighter-rouge&quot;&gt;3.10&lt;/code&gt;。&lt;/p&gt;

&lt;h4 id=&quot;22-常用的查看内核信息的命令&quot;&gt;2.2 常用的查看内核信息的命令&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;2.2.1 &lt;code class=&quot;highlighter-rouge&quot;&gt;uname&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;打印指定的系统信息。不带参数时，默认使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;-s&lt;/code&gt; 参数。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;参数：
    &lt;ul&gt;
      &lt;li&gt;-a, –all：按照下面的顺序打印所有信息，如果 -p 和 -i 未知时排除掉。&lt;/li&gt;
      &lt;li&gt;-s, –kernel-name：打印内核名字，一般就是 Linux。&lt;/li&gt;
      &lt;li&gt;-n, –nodename：打印网络节点的主机名。&lt;/li&gt;
      &lt;li&gt;-r, –kernel-release：打印内核发行版的版本。常用。3.10.0-514.26.2.el7.x86_64&lt;/li&gt;
      &lt;li&gt;-v, –kernel-version：打印内核的版本。#1 SMP Tue Jul 4 15:04:05 UTC 2017&lt;/li&gt;
      &lt;li&gt;-m, –machine：打印机器硬件名。&lt;/li&gt;
      &lt;li&gt;-p, –processor：打印处理器名字或“unknown”。&lt;/li&gt;
      &lt;li&gt;-i, –hardware-platform：打印硬件平台或“unknown”。&lt;/li&gt;
      &lt;li&gt;-o, –operating-system：打印操作系统。&lt;/li&gt;
      &lt;li&gt;–help：显示这个帮助并退出。&lt;/li&gt;
      &lt;li&gt;–version：显示这版本信息并退出。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;实例&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;c&quot;&gt;# uname -r&lt;/span&gt;
    3.10.0-514.26.2.el7.x86_64
    &lt;span class=&quot;c&quot;&gt;# uname -a&lt;/span&gt;
    Linux VM_139_74_centos 3.10.0-514.26.2.el7.x86_64 &lt;span class=&quot;c&quot;&gt;#1 SMP Tue Jul 4 15:04:05 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# cat /etc/redhat-release &lt;/span&gt;
    CentOS Linux release 7.2.1511 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Core&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;2.2.2  &lt;code class=&quot;highlighter-rouge&quot;&gt;/proc&lt;/code&gt; 虚拟文件系统&lt;/strong&gt;&lt;br /&gt;
内核空间和用户空间通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;/proc&lt;/code&gt; 虚拟文件系统可以通信。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/proc&lt;/code&gt; 目录中包含一些目录和虚拟文件，这些虚拟文件可以向用户呈现内核信息或者从用户空间向内核发送信息。&lt;/p&gt;

&lt;p&gt;常用文件：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;cpuinfo：标识了处理器的类型和速度&lt;/li&gt;
  &lt;li&gt;pci：显示在 PCI 总线上找到的设备&lt;/li&gt;
  &lt;li&gt;modules：当前加载到内核中的模块&lt;/li&gt;
  &lt;li&gt;version：系统版本及内核版本&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;示例：&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;c&quot;&gt;# cat /proc/version &lt;/span&gt;
    Linux version 3.10.0-514.26.2.el7.x86_64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;builder@kbuilder.dev.centos.org&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gcc version 4.8.5 20150623 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Red Hat 4.8.5-11&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GCC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#1 SMP Tue Jul 4 15:04:05 UTC 2017&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;3-备份数据&quot;&gt;3. 备份数据&lt;/h3&gt;
&lt;h3 id=&quot;4-升级内核&quot;&gt;4. 升级内核&lt;/h3&gt;
&lt;p&gt;记得首先更新仓库：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    yum -y update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;41-启用-elrepo-仓库&quot;&gt;4.1 启用 ELRepo 仓库&lt;/h4&gt;

&lt;p&gt;ELRepo 仓库是基于社区的用于企业级 Linux 仓库，提供对 RedHat Enterprise (RHEL) 和 其他基于 RHEL的 Linux 发行版（CentOS、Scientific、Fedora 等）的支持。&lt;br /&gt;
ELRepo 聚焦于和硬件相关的软件包，包括文件系统驱动、显卡驱动、网络驱动、声卡驱动和摄像头驱动等。&lt;/p&gt;

&lt;p&gt;启用 ELRepo 仓库：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
# rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;42-查看可用的系统内核包&quot;&gt;4.2 查看可用的系统内核包:&lt;/h4&gt;

&lt;p&gt;可以看到，只有 4.4 和 4.15 两个版本可以使用：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    # yum --disablerepo=&quot;*&quot; --enablerepo=&quot;elrepo-kernel&quot; list available
    Loaded plugins: fastestmirror, langpacks
    elrepo-kernel                                                   | 2.9 kB  00:00:00     
    elrepo-kernel/primary_db                                        | 1.7 MB  00:00:02     
    Determining fastest mirrors
    * elrepo-kernel: elrepo.org
    Available Packages
    kernel-lt.x86_64                           4.4.118-1.el7.elrepo            elrepo-kernel
    kernel-lt-devel.x86_64                     4.4.118-1.el7.elrepo            elrepo-kernel
    kernel-lt-doc.noarch                       4.4.118-1.el7.elrepo            elrepo-kernel
    kernel-lt-headers.x86_64                   4.4.118-1.el7.elrepo            elrepo-kernel
    kernel-lt-tools.x86_64                     4.4.118-1.el7.elrepo            elrepo-kernel
    kernel-lt-tools-libs.x86_64                4.4.118-1.el7.elrepo            elrepo-kernel
    kernel-lt-tools-libs-devel.x86_64          4.4.118-1.el7.elrepo            elrepo-kernel
    kernel-ml.x86_64                           4.15.6-1.el7.elrepo             elrepo-kernel
    kernel-ml-devel.x86_64                     4.15.6-1.el7.elrepo             elrepo-kernel
    kernel-ml-doc.noarch                       4.15.6-1.el7.elrepo             elrepo-kernel
    kernel-ml-headers.x86_64                   4.15.6-1.el7.elrepo             elrepo-kernel
    kernel-ml-tools.x86_64                     4.15.6-1.el7.elrepo             elrepo-kernel
    kernel-ml-tools-libs.x86_64                4.15.6-1.el7.elrepo             elrepo-kernel
    kernel-ml-tools-libs-devel.x86_64          4.15.6-1.el7.elrepo             elrepo-kernel
    perf.x86_64                                4.15.6-1.el7.elrepo             elrepo-kernel
    python-perf.x86_64                   
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;43-安装最新内核&quot;&gt;4.3 安装最新内核:&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    # yum --enablerepo=elrepo-kernel install kernel-ml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;--enablerepo&lt;/code&gt; 选项开启 CentOS 系统上的指定仓库。默认开启的是 &lt;code class=&quot;highlighter-rouge&quot;&gt;elrepo&lt;/code&gt;，这里用 &lt;code class=&quot;highlighter-rouge&quot;&gt;elrepo-kernel&lt;/code&gt; 替换&lt;/p&gt;

&lt;h3 id=&quot;5-设置-grub2&quot;&gt;5. 设置 grub2&lt;/h3&gt;

&lt;p&gt;内核安装好后，需要设置为默认启动选项并重启后才会生效&lt;/p&gt;

&lt;h4 id=&quot;51-查看系统上的所有可以内核&quot;&gt;5.1 查看系统上的所有可以内核：&lt;/h4&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# sudo awk -F\' '$1==&quot;menuentry &quot; {print i++ &quot; : &quot; $2}' /etc/grub2.cfg
0 : CentOS Linux (4.15.6-1.el7.elrepo.x86_64) 7 (Core)
1 : CentOS Linux (3.10.0-514.26.2.el7.x86_64) 7 (Core)
2 : CentOS Linux (3.10.0-327.el7.x86_64) 7 (Core)
3 : CentOS Linux (0-rescue-f9d400c5e1e8c3a8209e990d887d4ac1) 7 (Core)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;52-设置-grub2&quot;&gt;5.2 设置 grub2&lt;/h4&gt;

&lt;p&gt;机器上存在 4 个内核，我们要使用 4.15 这个版本，可以通过 grub2-set-default 0 命令或编辑 /etc/default/grub 文件来设置。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;通过 grub2-set-default 0&lt;/code&gt; 命令设置：&lt;br /&gt;
 其中 0 来自上一步的 awk 命令：&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; sudo grub2-set-default 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;编辑 &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/default/grub&lt;/code&gt; 文件&lt;/p&gt;

    &lt;p&gt;设置 &lt;code class=&quot;highlighter-rouge&quot;&gt;GRUB_DEFAULT=0&lt;/code&gt;，表示使用上一步的 &lt;code class=&quot;highlighter-rouge&quot;&gt;awk&lt;/code&gt; 命令显示的编号为 0 的内核作为默认内核：&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; # vi /etc/default/grub

 &amp;gt; GRUB_TIMEOUT=5
 &amp;gt; GRUB_DISTRIBUTOR=&quot;$(sed 's, release .*$,,g' /etc/system-release)&quot;
 &amp;gt; GRUB_DEFAULT=0
 &amp;gt; GRUB_DISABLE_SUBMENU=true
 &amp;gt; GRUB_TERMINAL_OUTPUT=&quot;console&quot;
 &amp;gt; GRUB_CMDLINE_LINUX=&quot;crashkernel=auto console=ttyS0 console=tty0 panic=5&quot;
 &amp;gt; GRUB_DISABLE_RECOVERY=&quot;true&quot;
 &amp;gt; GRUB_TERMINAL=&quot;serial console&quot;
 &amp;gt; GRUB_TERMINAL_OUTPUT=&quot;serial console&quot;
 &amp;gt; GRUB_SERIAL_COMMAND=&quot;serial --speed=9600 --unit=0 --word=8 --parity=no --stop=1&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;53-生成-grub-配置文件并重启&quot;&gt;5.3 生成 grub 配置文件并重启&lt;/h4&gt;

&lt;p&gt;下一步，通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;gurb2-mkconfig&lt;/code&gt; 命令创建 &lt;code class=&quot;highlighter-rouge&quot;&gt;grub2&lt;/code&gt; 的配置文件，然后重启：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    sudo grub2-mkconfig -o /boot/grub2/grub.cfg
    sudo reboot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;54-验证&quot;&gt;5.4 验证&lt;/h4&gt;
&lt;p&gt;通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;uname -r&lt;/code&gt; 查看，可以发现已经生效了。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    # uname -r
    4.15.6-1.el7.elrepo.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;6-删除旧内核可选&quot;&gt;6. 删除旧内核（可选）&lt;/h3&gt;

&lt;p&gt;内核有两种删除方式：通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;yum remove&lt;/code&gt; 命令或通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;yum-utils&lt;/code&gt; 工具。&lt;/p&gt;

&lt;h4 id=&quot;61-通过-yum-remove-命令&quot;&gt;6.1 通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;yum remove&lt;/code&gt; 命令&lt;/h4&gt;

&lt;p&gt;查看系统中全部的内核：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    # rpm -qa | grep kernel
    kernel-tools-libs-3.10.0-514.26.2.el7.x86_64
    kernel-ml-4.15.6-1.el7.elrepo.x86_64
    kernel-3.10.0-327.el7.x86_64
    kernel-tools-3.10.0-514.26.2.el7.x86_64
    kernel-headers-3.10.0-514.26.2.el7.x86_64
    kernel-3.10.0-514.26.2.el7.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;删除旧内核的 RPM 包&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    yum remove kernel-tools-libs-3.10.0-514.26.2.el7.x86_64 kernel-3.10.0-327.el7.x86_64 kernel-tools-3.10.0-514.26.2.el7.x86_64 kernel-headers-3.10.0-514.26.2.el7.x86_64 kernel-3.10.0-514.26.2.el7.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;62-通过-yum-utils-工具&quot;&gt;6.2 通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;yum-utils&lt;/code&gt; 工具&lt;/h3&gt;
&lt;p&gt;如果安装的内核不多于 3 个，yum-utils 工具不会删除任何一个。只有在安装的内核大于 3 个时，才会自动删除旧内核。&lt;/p&gt;

&lt;h4 id=&quot;621-安装&quot;&gt;6.2.1 安装&lt;/h4&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    yum install yum-utils
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;622-删除&quot;&gt;6.2.2 删除&lt;/h4&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    package-cleanup --oldkernels
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>qifeng</name></author><category term="linux" /><category term="centos" /><category term="kernel" /><category term="update" /><summary type="html">CentOS7升级Linux内核</summary></entry><entry><title type="html">使用frp内网穿透映射内网svn</title><link href="http://0.0.0.0:4000/2019/11/29/frp-svn.html" rel="alternate" type="text/html" title="使用frp内网穿透映射内网svn" /><published>2019-11-29T22:30:00+08:00</published><updated>2019-11-29T22:30:00+08:00</updated><id>http://0.0.0.0:4000/2019/11/29/frp-svn</id><content type="html" xml:base="http://0.0.0.0:4000/2019/11/29/frp-svn.html">&lt;h1 id=&quot;frp内网-穿透映射使内网svn可外网访问&quot;&gt;frp内网 穿透映射使内网svn可外网访问&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;部署准备&lt;/li&gt;
  &lt;li&gt;需要有一个带固定IP的服务器，用来服务端部署&lt;/li&gt;
  &lt;li&gt;如果想用域名访问的话，还需要准备一个域名，指向上方的服务端服务器&lt;/li&gt;
  &lt;li&gt;从github中release中下载即可，写文章时，作者刚release一个新版本v0.23.0，linux和windows下载amd64(64位)或者386(32位)，貌似还支持嵌入式arm版本什么的&lt;/li&gt;
  &lt;li&gt;下载解压后主要有frps(服务端)和frpc(客户端)两种，可以根据教程进行部署了&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;frp&quot;&gt;frp&lt;/h2&gt;
&lt;p&gt;这个东西配置还是挺复杂的，&lt;a href=&quot;https://github.com/fatedier/frp&quot;&gt;github地址&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;开始部署&quot;&gt;开始部署&lt;/h2&gt;
&lt;p&gt;目前服务器端用的linux，而客户端用的是windows，两者配置和命令基本一致：&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;服务端用到的是frps，修改 &lt;code class=&quot;highlighter-rouge&quot;&gt;frps.ini&lt;/code&gt; 文件&lt;/p&gt;

    &lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;common]
  &lt;span class=&quot;c&quot;&gt;#服务端绑定端口&lt;/span&gt;
  bind_port &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 7000
  &lt;span class=&quot;c&quot;&gt;#服务端token&lt;/span&gt;
  token &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; xxxxxx
  &lt;span class=&quot;c&quot;&gt;#服务端设置https访问端口&lt;/span&gt;
  vhost_https_port &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 7000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;token为服务端token，客户端需要与此一致，由于svn开的是8443https访问，所以当需要域名时则需要设置vhost_https_port（如果不用域名，此行可省略，或者用http的话就需要vhost_http_port参数）&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;客户端用到的是frpc，修改 &lt;code class=&quot;highlighter-rouge&quot;&gt;frpc.ini&lt;/code&gt; 文件&lt;/p&gt;
    &lt;ol&gt;
      &lt;li&gt;
        &lt;p&gt;用域名&lt;/p&gt;

        &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; [common]
 #服务端IP
 server_addr = xx.xx.xx.xx
 #服务端端口
 server_port = 7000
 #与服务端token一致
 token = xxxxxx
 [svn]
 #由于svn用的是https访问，这里设置为https
 type = https
 #由于svn的端口是8443，这里设置为8443
 local_port = 8443
 #此为绑定的域名
 custom_domains = example.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;

        &lt;p&gt;此时svn访问地址为：https://example.com:7000/svn/项目名称 ，需要注意的是7000是vhost_https_port代表的地址，它可以 &lt;code class=&quot;highlighter-rouge&quot;&gt;bind_port&lt;/code&gt; 同用一个，所以为了少开放端口就用了一个。&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;用IP&lt;/p&gt;
        &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; [common]
 #服务端IP
 server_addr = xx.xx.xx.xx
 #服务端端口
 server_port = 7000
 #与服务端token一致
 token =xxxxxx
 [svn]
 #用IP访问所以设置为tcp
 type = tcp
 #由于svn的端口是8443，这里设置为8443
 local_port = 8443
 #此为绑定的域名端口，地址中是要带此端口而不是上方的7000端口
 remote_port = 9000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;

        &lt;p&gt;此时svn访问地址为：https://xx.xx.xx.xx:9000/svn/项目名称&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;以上的配置仅仅是简单的配置，更多功能请查看官方文档，服务端启动命令就是在此目录下 &lt;code class=&quot;highlighter-rouge&quot;&gt;./frps -c ./frps.ini&lt;/code&gt;，客户端同理 &lt;code class=&quot;highlighter-rouge&quot;&gt;./frpc -c ./frpc.ini&lt;/code&gt; ，都启动后，在家中的机器中直接 &lt;code class=&quot;highlighter-rouge&quot;&gt;checkout&lt;/code&gt; 项目，输入上方的svn访问地址即可下载。&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;特别需要要注意的是，请开放上述涉及到的7000端口，如果用IP，则还需要开放9000端口，否则checkout会卡住超时。&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;优化-后台执行&quot;&gt;优化 后台执行&lt;/h2&gt;
&lt;p&gt;通过上方部署后，已经可以正常访问了，但是命令只能前台运行，所以我们需要将其部署到后台运行，否则太麻烦而且容易不小心关闭。分为linux和windows两平台。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;linux端&lt;br /&gt;
  由于是centos7，所以通过systemctl来后台运行：&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  [Unit]
  Description=fraps service
  After=network.target syslog.target
  Wants=network.target
  [Service]
  Type=simple
  #这里是和上方的命令一致的，请按照自己的实际路径修改，如果你客户端是在linux中，将frps改为frpc即可
  ExecStart=/home/xxx/frp/frp_0.22.0_linux_amd64/frps -c /home/xxx/frp/frp_0.22.0_linux_amd64/frps.ini
  [Install]
  WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;此时通过systemctl start frps即可启动服务端，更多的命名请搜索systemctl相关用法。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;windows端&lt;br /&gt;
  我这边采用的是WinSW来部署服务，安装步骤：&lt;/p&gt;

    &lt;ol&gt;
      &lt;li&gt;
        &lt;p&gt;release中下载WinSW.NET4.exe和sample-minimal.xml这两个（电脑中有.net4.0所以选的4版本的），放到同一目录中。&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;将sample-minimal.xml修改为WinSW.NET4.xml，当然也可以将两个都改简短一些，但需要同名才行。&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;配置WinSW.NET4.xml如下：&lt;/p&gt;

        &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &amp;lt;configuration&amp;gt;
     &amp;lt;!--服务ID--&amp;gt;
     &amp;lt;id&amp;gt;frpc&amp;lt;/id&amp;gt;
     &amp;lt;!-- 服务名称 --&amp;gt;
     &amp;lt;name&amp;gt;frp Client (powered by WinSW)&amp;lt;/name&amp;gt;
     &amp;lt;!-- 服务描述 --&amp;gt;
     &amp;lt;description&amp;gt;frp内网穿透客户端&amp;lt;/description&amp;gt;
     &amp;lt;!-- 路径，请按照自己的路径配置，如果服务端在windows中，将frpc改为frps即可,%BASE%就是当前文件位置 --&amp;gt;
     &amp;lt;executable&amp;gt;%BASE%\frp\frpc.exe&amp;lt;/executable&amp;gt;
     &amp;lt;arguments&amp;gt;-c %BASE%\frp\frpc.ini&amp;lt;/arguments&amp;gt;
 &amp;lt;/configuration&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;用&lt;strong&gt;管理员权限&lt;/strong&gt;运行cmd窗口，切换到WinSW文件所在的目录下，运行 &lt;code class=&quot;highlighter-rouge&quot;&gt;WinSW.NET4 install&lt;/code&gt;，即可生成服务，可以在管理工具-服务中找到此服务，如果出错，也会在当前目录下生成错误日志，对照排查即可。&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;此时运行WinSW.NET4 start启动客户端服务，也可直接在管理工具-服务中启动，更多的命令请搜索WinSW相关功能。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>qifeng</name></author><category term="frp" /><category term="svn" /><summary type="html">frp内网 穿透映射使内网svn可外网访问</summary></entry><entry><title type="html">浪潮服务器RAID 磁盘状态foreign解决方案</title><link href="http://0.0.0.0:4000/2019/11/29/langchao-raid-webbios.html" rel="alternate" type="text/html" title="浪潮服务器RAID 磁盘状态foreign解决方案" /><published>2019-11-29T04:35:13+08:00</published><updated>2019-11-29T04:35:13+08:00</updated><id>http://0.0.0.0:4000/2019/11/29/langchao-raid-webbios</id><content type="html" xml:base="http://0.0.0.0:4000/2019/11/29/langchao-raid-webbios.html">&lt;h2 id=&quot;解决方案记录&quot;&gt;解决方案记录&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/systemime/my_image/blob/master/Ctrl%2BH%20%E6%B5%AA%E6%BD%AERaid%E9%85%8D%E7%BD%AE%E6%96%87%E6%A1%A3%20-%20%E5%BC%A0%E5%86%B2andy%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.pdf&quot;&gt;Ctrl+H 浪潮Raid配置文档&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/systemime/my_image/raw/master/RAID%20%E7%A3%81%E7%9B%98%E7%8A%B6%E6%80%81%E4%B8%BAforeign%EF%BC%8C%E6%80%8E%E4%B9%88%E5%8F%98%E6%88%90ready%20-%20BigBao%E7%9A%84%E5%8D%9A%E5%AE%A2%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.pdf&quot;&gt;RAID 磁盘状态为foreign，怎么变成ready&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/systemime/my_image/raw/master/%E6%B5%AA%E6%BD%AE%E8%8B%B1%E4%BF%A1%E6%9C%8D%E5%8A%A1%E5%99%A8NF5270M3%E7%94%A8%E6%88%B7%E6%89%8B%E5%86%8CV1.0.pdf&quot;&gt;浪潮英信服务器NF5270M3用户手册V1.0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/systemime/my_image/raw/master/%E8%BF%90%E7%BB%B4%E6%97%A5%E5%B8%B8%E4%B9%8B%E6%9C%BA%E6%88%BF%E6%B5%AA%E6%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A1%AC%E7%9B%98%E7%BA%A2%E7%81%AF%E4%BA%AE%E8%B5%B7%EF%BC%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%80%E7%9B%B4%E5%93%8D%EF%BC%8Craid%E7%A3%81%E7%9B%98%E7%BA%A2%E8%89%B2%E3%80%82%E3%80%82%E3%80%82%E6%95%85%E9%9A%9C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%20-%20Rich%E4%B8%83%E5%93%A5%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.pdf&quot;&gt;运维日常之机房浪潮服务器硬盘红灯亮起，服务器一直响，raid磁盘红色。。。故障解决方法&lt;/a&gt;&lt;/p&gt;</content><author><name>true</name></author><category term="RAID" /><category term="WebBIOS" /><summary type="html">解决方案记录</summary></entry><entry><title type="html">django2.2关于”str object has no attribute decode” 的错误处理</title><link href="http://0.0.0.0:4000/2019/11/27/django-str-not-decode.html" rel="alternate" type="text/html" title="django2.2关于&quot;str object has no attribute decode&quot; 的错误处理" /><published>2019-11-27T00:00:00+08:00</published><updated>2019-11-27T00:00:00+08:00</updated><id>http://0.0.0.0:4000/2019/11/27/django-str-not-decode</id><content type="html" xml:base="http://0.0.0.0:4000/2019/11/27/django-str-not-decode.html">&lt;h2 id=&quot;关于-str-object-has-no-attribute-decode-的报错处理&quot;&gt;关于 &lt;code class=&quot;highlighter-rouge&quot;&gt;'str' object has no attribute 'decode'&lt;/code&gt; 的报错处理&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;报错代码段&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;      &lt;span class=&quot;c&quot;&gt;# 位于/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/mysql/operations.py &lt;/span&gt;
      &lt;span class=&quot;c&quot;&gt;# 第140行&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;last_executed_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
          &lt;span class=&quot;c&quot;&gt;# With MySQLdb, cursor objects have an (undocumented) &quot;_executed&quot;&lt;/span&gt;
          &lt;span class=&quot;c&quot;&gt;# attribute where the exact query sent to the database is saved.&lt;/span&gt;
          &lt;span class=&quot;c&quot;&gt;# See MySQLdb/cursors.py in the source distribution.&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'_executed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;c&quot;&gt;# print(&quot;=========================&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&quot;, type(query))&lt;/span&gt;
          &lt;span class=&quot;c&quot;&gt;# 这句话是我自己加的&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'replace'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;报错信息&lt;br /&gt;
同时可以看出 &lt;code class=&quot;highlighter-rouge&quot;&gt;getattr&lt;/code&gt; 函数返回值类型为 &lt;code class=&quot;highlighter-rouge&quot;&gt;str&lt;/code&gt;&lt;/p&gt;
    &lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  (base) [soul@listener one_orm]$ python manage.py makemigrations
  =========================&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt; &amp;lt;class 'str'&amp;gt;
  Traceback (most recent call last):
    File &quot;manage.py&quot;, line 21, in &amp;lt;module&amp;gt;
      main()
    File &quot;manage.py&quot;, line 17, in main
      execute_from_command_line(sys.argv)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/__init__.py&quot;, line 381, in execute_from_command_line
      utility.execute()
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/__init__.py&quot;, line 375, in execute
      self.fetch_command(subcommand).run_from_argv(self.argv)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/base.py&quot;, line 323, in run_from_argv
      self.execute(*args, **cmd_options)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/base.py&quot;, line 364, in execute
      output = self.handle(*args, **options)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/base.py&quot;, line 83, in wrapped
      res = handle_func(*args, **kwargs)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/core/management/commands/makemigrations.py&quot;, line 101, in handle
      loader.check_consistent_history(connection)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/migrations/loader.py&quot;, line 283, in check_consistent_history
      applied = recorder.applied_migrations()
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/migrations/recorder.py&quot;, line 73, in applied_migrations
      if self.has_table():
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/migrations/recorder.py&quot;, line 56, in has_table
      return self.Migration._meta.db_table in self.connection.introspection.table_names(self.connection.cursor())
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/base/base.py&quot;, line 256, in cursor
      return self._cursor()
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/base/base.py&quot;, line 233, in _cursor
      self.ensure_connection()
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/base/base.py&quot;, line 217, in ensure_connection
      self.connect()
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/base/base.py&quot;, line 197, in connect
      self.init_connection_state()
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/mysql/base.py&quot;, line 231, in init_connection_state
      if self.features.is_sql_auto_is_null_enabled:
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/utils/functional.py&quot;, line 80, in __get__
      res = instance.__dict__[self.name] = self.func(instance)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/mysql/features.py&quot;, line 82, in is_sql_auto_is_null_enabled
      cursor.execute('SELECT @@SQL_AUTO_IS_NULL')
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/utils.py&quot;, line 103, in execute
      sql = self.db.ops.last_executed_query(self.cursor, sql, params)
    File &quot;/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/mysql/operations.py&quot;, line 147, in last_executed_query
      query = query.decode(errors='replace')
  AttributeError: 'str' object has no attribute 'decode'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;编码解码解释&quot;&gt;编码解码解释&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;p&gt;内存的Unicode格式编码成为硬盘Utf-8格式，逆过程为解码&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;编码：&lt;/strong&gt; 将文本转换成字节流的过程。即 &lt;code class=&quot;highlighter-rouge&quot;&gt;Unicode&lt;/code&gt;，特定格式的编码方式，产生特定的字节流保存在硬盘中(一般为utf-8格式)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;解码：&lt;/strong&gt; 将硬盘中的字节流转换成文本的过程。即特定格式的字节流 &lt;code class=&quot;highlighter-rouge&quot;&gt;Unicode&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt; 在内存中写的所有的字符，一视同仁，都是Unicode编码，但只有往硬盘保存或者基于网络传输时，才能确定你输入的字符是英文还好汉文，这就是&lt;code class=&quot;highlighter-rouge&quot;&gt;Unicode&lt;/code&gt;转换成其他编码格式的过程。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;decode(“utf-8”, “ignore”) 忽略其中有异常的编码，仅显示有效的编码&lt;/li&gt;
  &lt;li&gt;decode(“utf-8”, “replace”) 替换其中异常的编码，这个相对更容易找出错误字符编码&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;python3中字符串格式&quot;&gt;python3中字符串格式&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;文本字符串类型：&lt;br /&gt;
即我们通常定义的str类型的对象。在Python3中，str类型的对象都是Unicode，因此对于str类型的对象只有encode（）方法，没有decode（）方法（若运行，会报错）&lt;/li&gt;
  &lt;li&gt;字节字符串类型：&lt;br /&gt;
即byte类型的对象。对于该类对象，是由str类型对象使用encode()方法产生，byte对象可以进行解码过程，从而得到真正的内容&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;其实到这里我们已经知道报错原因了，继续往下看&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;python3中-getattr-函数&quot;&gt;python3中 &lt;code class=&quot;highlighter-rouge&quot;&gt;getattr()&lt;/code&gt; 函数&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;描述：&lt;br /&gt;
getattr()函数用于返回一个对象属性值&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;语法：&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  getattr(object,name,default)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;参数：
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;object&lt;/code&gt;–对象&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt;–字符串，对象属性&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;default&lt;/code&gt;–默认返回值，如果不提供该参数，在没有对于属性时，将触发AttributeError&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;返回值：&lt;br /&gt;
返回对象属性值&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;People&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;country&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'China'&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;
     
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;people_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s is xxx'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;People&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'country'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;#返回值China&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;#obj=getattr(People,'countryaaaaaa')&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;#print(obj)&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;#报错&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# File &quot;/getattr()函数.py&quot;, line 32, in &amp;lt;module&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;#   obj=getattr(People,'countryaaaaaa')&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# AttributeError: type object 'People' has no attribute 'countryaaaaaa'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;People&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'countryaaaaaa'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;#返回值None&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;修改方案&quot;&gt;修改方案&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;结合上面python3中字符串的相关知识与 &lt;code class=&quot;highlighter-rouge&quot;&gt;getattr&lt;/code&gt; 函数返回值类型可以断定，这里的错误是由于 &lt;code class=&quot;highlighter-rouge&quot;&gt;str&lt;/code&gt; 没有 &lt;code class=&quot;highlighter-rouge&quot;&gt;decode（）&lt;/code&gt; 方法引起的&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;方案一&quot;&gt;方案一&lt;/h4&gt;
&lt;p&gt;直接对这两句代码进行注释&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 位于/home/soul/anaconda3/lib/python3.6/site-packages/django/db/backends/mysql/operations.py &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 第140行&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;last_executed_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# With MySQLdb, cursor objects have an (undocumented) &quot;_executed&quot;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# attribute where the exact query sent to the database is saved.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# See MySQLdb/cursors.py in the source distribution.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'_executed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# if query is not None:&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#     query = query.decode(errors='replace')&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;方案二&quot;&gt;方案二&lt;/h4&gt;
&lt;p&gt;这个方案看起来有些多余，对比 &lt;code class=&quot;highlighter-rouge&quot;&gt;django&lt;/code&gt; 1.11版本代码以及代码段注释，这段代码加入的具体意义有些莫名其妙&lt;/p&gt;

&lt;p&gt;但是为了保险起见，可以加入 &lt;code class=&quot;highlighter-rouge&quot;&gt;try&lt;/code&gt; 方法达到另一种注释的方法&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;last_executed_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# With MySQLdb, cursor objects have an (undocumented) &quot;_executed&quot;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# attribute where the exact query sent to the database is saved.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# See MySQLdb/cursors.py in the source distribution.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'_executed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'replace'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;还没结束&quot;&gt;还没结束！！！&lt;/h2&gt;
&lt;p&gt;众所周知，&lt;code class=&quot;highlighter-rouge&quot;&gt;django&lt;/code&gt; 是个开源项目，那么为什么去不去github上看看呢？&lt;/p&gt;

&lt;p&gt;我在 &lt;code class=&quot;highlighter-rouge&quot;&gt;Pull requests&lt;/code&gt; 中并没有找到想要的答案，于是我在django项目里按照目录寻找 &lt;code class=&quot;highlighter-rouge&quot;&gt;operations.py&lt;/code&gt; 文件&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;django/django/db/backends/mysql/operations.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;果然，开源社区最棒！！！&lt;/p&gt;

&lt;p&gt;在最新的代码中， &lt;code class=&quot;highlighter-rouge&quot;&gt;last_executed_query&lt;/code&gt; 函数被修改成如下&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 19年11月27日，位于157行&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;last_executed_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# With MySQLdb, cursor objects have an (undocumented) &quot;_executed&quot;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# attribute where the exact query sent to the database is saved.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# See MySQLdb/cursors.py in the source distribution.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# MySQLdb returns string, PyMySQL bytes.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'_executed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'replace'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;force_str&lt;/code&gt; 方法定义在 &lt;code class=&quot;highlighter-rouge&quot;&gt;django/django/utils/encoding.py&lt;/code&gt; 的48行，对比目前代码&lt;/p&gt;

&lt;p&gt;本地的代码为：&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DjangoUnicodeDecodeError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;UnicodeDecodeError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s. You passed in &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;r (&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s)'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;is_protected_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;Determine if the object instance is of a protected type.

    Objects of protected types are preserved as-is when passed to
    force_text(strings_only=True).
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_PROTECTED_TYPES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;force_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strings_only&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'strict'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
    Similar to smart_text, except that lazy instances are resolved to
    strings, rather than kept as lazy objects.

    If strings_only is True, don't convert (some) non-string-like objects.
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# Handle the common case first for performance reasons.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;issubclass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strings_only&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is_protected_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;UnicodeDecodeError&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DjangoUnicodeDecodeError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;force_str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_text&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;对比发现，(本地环境为 &lt;code class=&quot;highlighter-rouge&quot;&gt;django2.2.6&lt;/code&gt; )，在我本地django源码中，&lt;code class=&quot;highlighter-rouge&quot;&gt;force_str&lt;/code&gt; 方法和 &lt;code class=&quot;highlighter-rouge&quot;&gt;force_text&lt;/code&gt; 相同，而其他部分与github目前代码相同，尝试修改&lt;code class=&quot;highlighter-rouge&quot;&gt;operations.py&lt;/code&gt; 文件与github相同&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.utils.encoding&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_text&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;last_executed_query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# With MySQLdb, cursor objects have an (undocumented) &quot;_executed&quot;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# attribute where the exact query sent to the database is saved.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# See MySQLdb/cursors.py in the source distribution.&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# MySQLdb returns string, PyMySQL bytes.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;force_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;getattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cursor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'_executed'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'replace'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;运行测试：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(base) [soul@listener one_orm]$ python manage.py makemigrations
No changes detected
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;奥利给！！！！！&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;到此，问题解决&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name>qifeng</name></author><category term="error" /><category term="django" /><summary type="html">关于 'str' object has no attribute 'decode' 的报错处理</summary></entry><entry><title type="html">django2.2使用mako配置</title><link href="http://0.0.0.0:4000/2019/11/24/django-mako.html" rel="alternate" type="text/html" title="django2.2使用mako配置" /><published>2019-11-24T02:40:59+08:00</published><updated>2019-11-24T02:40:59+08:00</updated><id>http://0.0.0.0:4000/2019/11/24/django-mako</id><content type="html" xml:base="http://0.0.0.0:4000/2019/11/24/django-mako.html">&lt;h3 id=&quot;一安装mako&quot;&gt;一、安装mako&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip install mako
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;二创建mako配置文件&quot;&gt;二、创建mako配置文件&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;该步骤最重要的是重写了render函数&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;在app内新建-base_renderpy-文件&quot;&gt;在app内新建 &lt;code class=&quot;highlighter-rouge&quot;&gt;base_render.py&lt;/code&gt; 文件&lt;/h4&gt;

&lt;blockquote&gt;
  &lt;p&gt;文件名可变，保证引用正确即可&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;写入如下内容：&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#coding:utf-8&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;mako.lookup&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TemplateLookup&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.template&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RequestContext&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.conf&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.template.context&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.http&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpResponse&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;render_to_response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;context_instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RequestContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# 引入模板位置&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;settings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEMPLATES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'DIRS'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lookup&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TemplateLookup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;directories&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;output_encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;input_encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# 导入模板路径&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mako_template&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lookup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_template&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# 防空&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# 判断实例是否存&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context_instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context_instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# 加入csrf_token关键字 csrfmiddlewaretoke 中间件&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'csrf_token'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'&amp;lt;input type=&quot;hidden&quot; name=&quot;csrfmiddlewaretoken&quot; value=&quot;{0}&quot; /&amp;gt;'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;META&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'CSRF_COOKIE'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HttpResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mako_template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;在视图中-viewspy-导入mako配置&quot;&gt;在视图中 &lt;code class=&quot;highlighter-rouge&quot;&gt;views.py&lt;/code&gt; 导入mako配置&lt;/h3&gt;
&lt;p&gt;内容如下：&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.shortcuts&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.views.generic&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;View&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Create your views here.&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;.bash_render&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render_to_response&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 此句导入mako配置，引入重写的render方法&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;View&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 测试类&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'test.html'&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'dewei'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render_to_response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# 此处data = data中，第一个data为传入数据名，与base_render中定义的参数名需要相同&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;三使用测试&quot;&gt;三、使用测试&lt;/h3&gt;

&lt;h4 id=&quot;新建模板页-basehtml&quot;&gt;新建模板页 &lt;code class=&quot;highlighter-rouge&quot;&gt;base.html&lt;/code&gt;&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;```html
&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;http-equiv=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;X-UA-Compatible&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;IE=edge&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;${self.title()}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    ${self.css()}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!--子页面的导入--&amp;gt;&lt;/span&gt;
    ${self.content()}
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!--子页面js导入--&amp;gt;&lt;/span&gt;
    ${self.js()}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--主体函数--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;content()&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    ${self.main()}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;def&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--主函数--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;main()&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;def&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--标签名--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;title()&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;def&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--导入css和js--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;js()&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;def&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;css()&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;def&amp;gt;&lt;/span&gt;
```  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;新建子页面-testhtml&quot;&gt;新建子页面 &lt;code class=&quot;highlighter-rouge&quot;&gt;test.html&lt;/code&gt;&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;```html  
&amp;lt;!--引入主页面--&amp;gt;
&amp;lt;%inherit file=&quot;base.html&quot; /&amp;gt;

&amp;lt;!--标签页名--&amp;gt;
&amp;lt;%def name=&quot;title()&quot;&amp;gt;
    test
&amp;lt;/%def&amp;gt;

&amp;lt;!--js导入--&amp;gt;
&amp;lt;%def name=&quot;js()&quot;&amp;gt;
    &amp;lt;script src=&quot;https://cdn.bootcss.com/jquery/2.2.0/jquery.js&quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;/%def&amp;gt;

&amp;lt;!--主内容--&amp;gt;
&amp;lt;%def name=&quot;main()&quot;&amp;gt;
    &amp;lt;h1&amp;gt;hello mako&amp;lt;/h1&amp;gt;
&amp;lt;/%def&amp;gt;

&amp;lt;!--css导入--&amp;gt;
&amp;lt;%def name=&quot;css()&quot;&amp;gt;
    &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;/static/test.css&quot; /&amp;gt;
&amp;lt;/%def&amp;gt;

&amp;lt;!--
&amp;lt;!--mako变量显示方法--&amp;gt;
${name}
${age}

&amp;lt;br /&amp;gt;
&amp;lt;!--mako 在页面中导入模块--&amp;gt;
&amp;lt;%!
    from django.conf import settings
%&amp;gt;
&amp;lt;!--mako 输出--&amp;gt;
${settings.TEMPLATES[0]['DIRS'][0]}

&amp;lt;br /&amp;gt;
&amp;lt;!--csrf验证--&amp;gt;
${csrf_token}

&amp;lt;br /&amp;gt;

&amp;lt;!--mako 在页面中循环用法--&amp;gt;
%for i in range(20):
    &amp;lt;input type=&quot;text&quot; value=&quot;${i}&quot; /&amp;gt;
%endfor

&amp;lt;!--mako 在页面中定义函数并使用--&amp;gt;
&amp;lt;%!
def name():
    return 'my name is qifeng'
%&amp;gt;

&amp;lt;input style=&quot;display: block&quot; type=&quot;text&quot; name=&quot;username&quot; value=&quot;${name()}&quot; /&amp;gt;

--&amp;gt;
```  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;不同页面之间传参&quot;&gt;不同页面之间传参&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;在子页面 &lt;code class=&quot;highlighter-rouge&quot;&gt;test.html&lt;/code&gt; 中
    &lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nt&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;main()&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;file=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;extend.html&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;args=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;local_content='你好 mako'&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;c&quot;&gt;&amp;lt;!--参数传递, file为引入文件名，args为引入界面的变量名及参数内容--&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;def&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;在 &lt;code class=&quot;highlighter-rouge&quot;&gt;extend.html&lt;/code&gt; 中
    &lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;nt&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;args=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;local_content&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;&amp;lt;!--通过page方法定义args使得其他页面能定位该页面位置，能够将local_content内容传入--&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;textarea&amp;gt;&lt;/span&gt;
  ${local_content}
  &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- local_content仅仅是个变量名 --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/textarea&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>qifeng</name></author><category term="mako" /><category term="django" /><summary type="html">一、安装mako</summary></entry><entry><title type="html">django2.2使用jinja配置</title><link href="http://0.0.0.0:4000/2019/11/21/django-jinja.html" rel="alternate" type="text/html" title="django2.2使用jinja配置" /><published>2019-11-21T02:40:59+08:00</published><updated>2019-11-21T02:40:59+08:00</updated><id>http://0.0.0.0:4000/2019/11/21/django-jinja</id><content type="html" xml:base="http://0.0.0.0:4000/2019/11/21/django-jinja.html">&lt;h2 id=&quot;使用jinja2jinja2代替djangodjangotemplates&quot;&gt;使用jinja2.Jinja2代替django.DjangoTemplates&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;django2.1.2以前的版本中，django可以将原来的DjangoTempaltes模板引擎直接替换为jinja引擎,但是在django2.2.6版本中测试只能采用新增jinja模板的方式，不能直接替换，否则会产生如下错误,其他版本暂未测试，以下内容仅供参考&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ERRORS:
?: (admin.E403) A 'django.template.backends.django.DjangoTemplates' instance must be configured in TEMPLATES in order to use the admin application.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;以下是具体配置&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;应用app内创建&lt;code class=&quot;highlighter-rouge&quot;&gt;base_jinja.py&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;新建jinja路由内容&lt;/strong&gt;
    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;c&quot;&gt;#coding:utf-8&lt;/span&gt;

 &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;jinja2&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Environment&lt;/span&gt;
 &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.contrib.staticfiles.storage&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticfiles_storage&lt;/span&gt;
 &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.urls&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reverse&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;# 该部分代码来自django、jinja广泛文档介绍，类似基础配置  &lt;/span&gt;
    
 &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Environment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
     &lt;span class=&quot;c&quot;&gt;# 全局的数据，路由&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;globals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'static'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;staticfiles_storage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'url'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reverse&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&lt;del&gt;在setting中修改templates配置&lt;/del&gt;&lt;/strong&gt; 在setting中添加如下配置&lt;br /&gt;
 &lt;a href=&quot;https://docs.djangoproject.com/en/2.2/topics/templates/#django.template.backends.django.DjangoTemplates&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Django&lt;/code&gt;文档中有关&lt;code class=&quot;highlighter-rouge&quot;&gt;jinja&lt;/code&gt;的说明&lt;/a&gt;&lt;br /&gt;
 3.1 新增模板引擎&lt;br /&gt;
 3.2 添加其他参数&lt;br /&gt;
 3.3 完整配置如下
    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;n&quot;&gt;TEMPLATES&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'BACKEND'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'django.template.backends.django.DjangoTemplates'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'DIRS'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'APP_DIRS'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'OPTIONS'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
             &lt;span class=&quot;s&quot;&gt;'context_processors'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
                 &lt;span class=&quot;s&quot;&gt;'django.template.context_processors.debug'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;s&quot;&gt;'django.template.context_processors.request'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;s&quot;&gt;'django.contrib.auth.context_processors.auth'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;s&quot;&gt;'django.contrib.messages.context_processors.messages'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'BACKEND'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'django.template.backends.jinja2.Jinja2'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# jinja模板引擎&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'DIRS'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BASE_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'templates'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 可以使用app内的template自定义文件夹&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'APP_DIRS'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         &lt;span class=&quot;s&quot;&gt;'OPTIONS'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
             &lt;span class=&quot;s&quot;&gt;'environment'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'myjinjia.base_jinja.environment'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# 添加jinja2模板引擎虚拟环境&lt;/span&gt;
             &lt;span class=&quot;s&quot;&gt;'context_processors'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;c&quot;&gt;# 默认为空即可,具体配置参考django文档&lt;/span&gt;
             &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
     &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
 &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;启动
    &lt;blockquote&gt;
      &lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;jinja&lt;/code&gt; &lt;strong&gt;不建议与&lt;/strong&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;django&lt;/code&gt; &lt;strong&gt;的上下文处理器一起使用&lt;/strong&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;jinja模板语法举例(与DjangoTemplate区别不大)&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;名称&lt;/th&gt;
          &lt;th&gt;描述&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;title&lt;/td&gt;
          &lt;td&gt;首字母大写&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;测试
    &lt;ul&gt;
      &lt;li&gt;没有&lt;code class=&quot;highlighter-rouge&quot;&gt;{&lt;span&gt;% load %}&lt;/span&gt;&lt;/code&gt;的方法，增加会报错&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{&lt;span&gt;% extends 'base.html' %}&lt;/span&gt;&lt;/code&gt;
        &lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  {% extends &quot;base.html&quot; %}
        
        
  {% block css_style %}
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/static/test.css&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  {% endblock %}
        
  {% block content %}
                    
  {% endblock %}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;过滤器传参数使用括号
        &lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  {{ age|test(int_type num) }}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;自定义过滤器
    &lt;ul&gt;
      &lt;li&gt;同app下新建myfilter.py文件，内容如下
        &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c&quot;&gt;#cofing:utf-8&lt;/span&gt;
        
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;在base_jinja.py中增加自定义过滤器信息
        &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c&quot;&gt;#coding:utf-8&lt;/span&gt;
  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.templatetags.static&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt;
  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.urls&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reverse&lt;/span&gt;
        
  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;jinja2&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Environment&lt;/span&gt;
        
  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;.myfilter&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;
  &lt;span class=&quot;c&quot;&gt;# 新增&lt;/span&gt;
        
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Environment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;globals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;'static'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;static&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;'url'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reverse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'test'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;
      &lt;span class=&quot;c&quot;&gt;# 新增&lt;/span&gt;
        
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;在html中
        &lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  {{ age|test(int_type num) }}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name>qifeng</name></author><category term="jinja" /><category term="django" /><summary type="html">使用jinja2.Jinja2代替django.DjangoTemplates</summary></entry><entry><title type="html">django2.2中Template模板使用</title><link href="http://0.0.0.0:4000/2019/11/19/django2-template.html" rel="alternate" type="text/html" title="django2.2中Template模板使用" /><published>2019-11-19T22:40:59+08:00</published><updated>2019-11-19T22:40:59+08:00</updated><id>http://0.0.0.0:4000/2019/11/19/django2-template</id><content type="html" xml:base="http://0.0.0.0:4000/2019/11/19/django2-template.html">&lt;h2 id=&quot;多个参数传入方法&quot;&gt;多个参数传入方法&lt;/h2&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 在view中&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.shortcuts&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.views&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;View&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Xxx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;View&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'xxx.html'&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;xxx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'first'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- html中,body内部任意标签位置--&amp;gt;&lt;/span&gt;
{{ first }}
{{ name }}
{{ age }}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;引入模板页&quot;&gt;引入模板页&lt;/h1&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;```
{% extend ‘xxx.html’ %}
# 不需要{%  %}结束
# html文件存放在template内部
# 像系统环境中加入template目录写法
DIRS = os.join.path(BASE_DIR, 'templates')
```  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;导入css&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{% load static %}
{% block css_style %}
&lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;''&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'{% static '&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;xxx&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;css&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;'&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;%}'&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
{% endblock %}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;html内写模板变量&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 在html中
&lt;span class=&quot;nt&quot;&gt;&amp;lt;x&amp;gt;&lt;/span&gt; hello {{ xxx }}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/x&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# 在view中&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.views&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;View&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.shortcuts&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Xxx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;View&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;xxx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;''&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'xxx.html'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'xxx_key'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xxx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;母版中定义自html文件内容位置&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{% block content %}

{% endblock %}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;子html中写文件内容&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{% block content %}

{% endblock %}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;子html内部定义文件title&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{% block title %}

{% endblock %}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;过滤器&quot;&gt;过滤器&lt;/h2&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python内部&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.shortcuts&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.views&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;View&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;datetime&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;View&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'index2.html'&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'array'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'count'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'time'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'cut_str'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'hello-boy!'&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'first_big'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'你好 django! haha'&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'result'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'dic_list'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'dewei'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'xiaoming'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'float_num'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;3.1415926&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'html_str'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'&amp;lt;div style=&quot;background-color:red;width:50px;height:50px&quot;&amp;gt;&amp;lt;/div&amp;gt;'&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'a_str'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'请看 www.baidu.com'&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'feature'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'time'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timedelta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;days&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# 注意，传入未来时间&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEMPLATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;add:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{count|add:10}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;date:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{time|date:&quot;Y-m-d H:i:s&quot;}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;cut:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{cut_str|cut:&quot;-&quot;}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;capfirst:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{first_big|capfirst}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;default:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{result|default:&quot;空&quot;}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;deafult_if_none:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{result|default_if_none:&quot;none才是空&quot;}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;dictsort:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{dic_list|dictsort:'age'}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;dictsortreversed:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{dic_list|dictsortreversed:'age'}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;first:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{dic_list|first}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;last:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{dic_list|last}} &lt;span class=&quot;nt&quot;&gt;&amp;lt;/br&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;floatformat:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{float_num|floatformat:4}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;join:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{array|join:&quot;-&quot;}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;length:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{dic_list|length}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;divisibleby:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{count|divisibleby:3}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;length_is:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{dic_list|length_is:2}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;safe:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{html_str|safe}} &lt;span class=&quot;nt&quot;&gt;&amp;lt;/br&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;random:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{dic_list|random}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;slice:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{html_str|slice:&quot;:10&quot;}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;slugify:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{html_str|slugify}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;upper:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{html_str|upper}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;urlize:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{a_str|urlize}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;wordcount:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{first_big|wordcount}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;label&amp;gt;&lt;/span&gt;timeuntil:&lt;span class=&quot;nt&quot;&gt;&amp;lt;/label&amp;gt;&lt;/span&gt;{{feature|timeuntil}}&lt;span class=&quot;nt&quot;&gt;&amp;lt;br&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--&amp;lt;label&amp;gt;custom:&amp;lt;/label&amp;gt;{{count|test:10}}--&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;过滤器解释&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;内置过滤器函数&lt;/th&gt;
      &lt;th&gt;使用方法举例&lt;/th&gt;
      &lt;th&gt;说明&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;add&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{value&amp;amp;#124;add:10}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;value值增加10&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;date&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{value&amp;amp;#124;date:&quot;Y-m-d H:i:s&quot;}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;让日期格式化显示&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;cut&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{cut_str&amp;amp;#124;cut:&quot;xxx&quot;}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;将value中xxx删除&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;capfirst&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{first_big&amp;amp;#124;capfirst}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;将value首字母大写&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;default&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{result&amp;amp;#124;default:&quot;值为false&quot;}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;值为false时使用默认值&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;default_if_none&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{result&amp;amp;#124;default_if_none:&quot;值为空&quot;}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;值为空时使用默认值&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;dictsort&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{dic_list&amp;amp;#124;dictsort:'age'}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;字典类型、按key排序&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;dictsortreversed&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{dic_list&amp;amp;#124;dictsortreversed:'age'}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;字典类型key反序&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;first&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{dic_list&amp;amp;#124;first}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;返回列表中第一个索引&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;floatformat&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{float_num#124;floatformat:4}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;保留小数默认一位&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;join&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{array#124;join:&quot;-&quot;}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;类似python中join语法&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;last&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{dic_list&amp;amp;#124;last}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;返回列表最后一个&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;length&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{dic_list#124;length}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;返回长度&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;divisibleby&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{count#124;divisibleby:3}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;若被整除返回true&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;length_is&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{dic_list#124;length_is:2}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;若长度为xxx返回true&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;safe&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{html_str#124;safe}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;让服务器返回的html内容字符串在浏览器显示&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;random&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{dic_list#124;random}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;随机显示某条索引&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;slice&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{html_str#124;slice:&quot;:10&quot;}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;切片&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;slugify&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{html_str#124;slugify}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;值小写 单词用-分割&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;upper&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{html_str#124;upper}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;内容全部大写&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;urlize&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{a_str#124;urlize}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;内容链接可点击（注意空格）&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;wordcount&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{first_big#124;wordcount}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;单词数量&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;timeuntil&lt;/td&gt;
      &lt;td&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;{{feature#124;timeuntil}}&lt;/code&gt;&lt;/td&gt;
      &lt;td&gt;距离当前时间的天数和小时数（未来）&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;自定义过滤器实现&quot;&gt;自定义过滤器实现&lt;/h2&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# app内新建文件夹如templateags&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 新建文件__init__.py、myfilter.py&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# myfilter.py文件内：&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;template&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;register&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Labrary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nd&quot;&gt;@register.filter&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 该解释器有name属性，可以定义自定义过滤器使用时的名称，默认为函数名&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# @register.filter(name='自定义名称')&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;在 &lt;code class=&quot;highlighter-rouge&quot;&gt;setting.py&lt;/code&gt; 自定义app注册下方添加&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;INSTALLED_APPS = [
	...
	'app.templateages',
]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;错误记录：&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;TypeError: expected str, bytes or os.PathLike object, not function

检查template文件夹有没有在setting文件内设置
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;html部分&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{% load myfilter %}

{{value|test:10}}}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>qifeng</name></author><category term="template" /><category term="django" /><summary type="html">多个参数传入方法</summary></entry></feed>